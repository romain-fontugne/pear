{% extends 'base.html' %}

{% block head %}
<title>Traffic data</title>
{% endblock %}

{% block body %}
<h1>Traffic data: {{ selected_router }}</h1>

<div class="dropdown">
  <button type="button" class="btn btn-primary dropdown-toggle" data-toggle="dropdown">
    Select a router
  </button>
  <div class="dropdown-menu">
      {% for router in router_names %}
        <a class="dropdown-item" href="/traffic?router={{router}}">{{router}}</a>
      {% endfor %}
  </div>
</div>

<table id="trafficTable" class="table table-striped table-sm table-hover" width="100%">
    <thead>
    <tr>
        <th>ASN</th>
        <th>Prefix</th>
        <th>Traffic Volume</th>
        <th>Country</th>
        <th>AS path</th>
        <th>Description</th>
    </tr>
    </thead>
    <tbody>
    {% for prefix, values in flows.items() %}
        <tr>
            <td>AS{{ values.info.originasn }}</td>
            <td>{{ prefix }}</td>
            <td>{{ values.vol }}</td>
            <td>{{ values.info.country }}</td>
            <td>
                {% for asn in values.info.aspath %}{{ asn }}&nbsp;&nbsp;{% endfor %}
            </td>
            <td>
                {% for irr_prefix, irr_values in values.info.irr.items() %}
                    {{ irr_values.descr }}
                {% endfor %}
            </td>
        </tr>
    {% endfor %}
    </tbody>
</table>

{% endblock %}

{% block footer %}
<script type="text/javascript">
    $(document).ready(function () {
        $('#trafficTable').DataTable({
            "paging": false,
            "fnInitComplete": function () {
                var myCustomScrollbar = document.querySelector('#trafficTable_wrapper .dataTables_scrollBody');
                var ps = new PerfectScrollbar(myCustomScrollbar);
            },
            "scrollY": 850,
        });
    $('.dataTables_length').addClass('bs-select');
    });
</script>
{% endblock %}
